#!/bin/bash

set -e

if [ "$#" -ne 2 ]; then
    echo "Usage: $(basename "${BASH_SOURCE[0]}") owner/repository branch"
    exit
fi

REPOSITORY=$1
BRANCH=$2
GIT_URL="https://github.com/$REPOSITORY.git"

if [[ ! -d cobra ]]; then
  git clone -b "$BRANCH" "$GIT_URL" cobra
fi

pushd cobra

git remote set-url origin "$GIT_URL"
git fetch
git checkout -B "$BRANCH" --track "origin/$BRANCH"

popd
